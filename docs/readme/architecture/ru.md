## Описание архитектуры проекта
Программный комплекс представляет собой решение для автоматического удаления фона с изображений c помощью нейронных сетей.

## Как это работает?

1. Пользователь выбирает картинку или папку с картинками для обработки
2. Происходит предобработка фотографии для обеспечения лучшего качества выходного изображения
3. С помощью технологии машинного обучения убирается фон у изображения
4. Происходит постобработка изображения для улучшения качества обработанного изображения

### Архитектура ПО
<div align="center">
<img src="./carvekit_arch.png" alt="Архитектура проекта">
</divб>

Архитектурно ПО состоит из следующих компонентов:
* Модуль предобработки;
* Модуль сегментации;
* Модуль постобработки.

Изображение при прохождении обработки передается последовательно по указанным модулям, возможно в составе пакета изображений (зависит от конфигурации, установленной пользователем при использовании)

## Описание функционала модулей

### Модуль предобработки
Состоит из классификаторов сцен и объектов, которые применяются в зависимости от сложности обрабатываемого изображения и определяют используемые в дальнейшем модули сегментации.

### Модуль сегментации
Модуль сегментации представлен двумя вариантами: TRACER и ISNet, конкретный модуль выбирается во время предобработки.
Модуль сегментации создает по изображению маску, представляющую собой вероятность для каждого пикселя изображения быть частью основного объекта на изображении. 
Помимо упомянутых модулей сегментации, в проекте представлены иные модули, которые могут быть использованы в качестве основного модуля сегментации:
1. U-2-Net;
2. BASNet;
3. DeepLabV3;

### Модуль постобработки
Модуль постобработки нивелирует ошибки при сегментации, доводя маску до требуемого качества. При постобработке применяются последовательно две модели: CascadePSP и FBA Matting. Они реализуют принципиально разные подходы и уточняют только края маски в тех областях, где вероятность, возвращаемая модулем сегментации, не позволяет с достаточной уверенностью судить о принадлежности пикселя к изображению. После постобработки маска применяется на изображения, оставляя видимыми только те пиксели входного изображения, которые в нее входят.


### Заметки по использованию модульной архитектуры ПК.
1. Не во всех случаях необходимо применять все модули. Например, если изображение содержит простой фон и объект, то иногда может быть достаточно применить только модуль сегментации, а модуль предобработки и постобработки можно не применять.
2. В случае, если изображение содержит сложный фон и полный пайплайн обработки не справляется с задачей, можно попробовать применить иные модели и модули сегментации, интегрированные в ПК, чтобы найти наиболее подходящий вариант, обеспечивающий требуемое качество обработки.

